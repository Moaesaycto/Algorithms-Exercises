\documentclass{article}

% Remember to also load the algostyle.sty file into your project.
\usepackage{algostyle}

% Insert new packages here.

\begin{document}
\begin{question}
Let $G = (V, E, w)$ be a weighted graph, where $w(e)$ denotes the weight of a given edge $e$. A {\em matching} is a subset $M \subseteq E$ of edges such that no two edges in $M$ share a common vertex. A matching is {\em perfect} if every vertex is included in exactly one edge in $M$.

Consider the following two problems:

\begin{itemize}
    \item $\compproblem{MinCostPerfectMatching}$ $(\compproblem{mcpm})$: given a weighted graph $G = (V, E, w)$, where the edge weights can be positive, negative, or zero, find a minimum-cost perfect matching $M$ (if there exist one; otherwise, report that none exists), where the cost of a matching $M$ is given by \[w(M) = \sum_{e \in M} w(e).\]

    \item $\compproblem{MaxWeightedPerfectMatching}$ $(\compproblem{mwpm})$: given a weighted graph $G = (V, E, w)$, where the edge weights are {\em non-negative}, find a maximum-weighted perfect matching $M$ (if there exist one; otherwise, report that none exists), where the weight of a matching $M$ is given by \[w(M) = \sum_{e \in M} w(e).\]
\end{itemize}

Consider the following polynomial-time reduction from $\compproblem{mcpm}$ to $\compproblem{mwpm}$.

{\bfseries Reduction}: Let $n$ be the number of vertices in $G$. If $n$ is odd, then there are no perfect matchings so report that none exists. We will now assume that the number of vertices is even. For each edge $e \in E$, define $\hat w(e) = w_{\max} - w(e) + 1$, where $w_{\max} = \max_{e \in E} w(e)$. Let $\displaystyle\Delta = \sum_{e \in E} \hat w(e)$.

We construct $G^* = (V^*, E^*, w^*)$ as follows: we keep the same vertices and edges; that is, $V^* = V$, $E^* = E$. For each edge $e \in E^*$, we have $w^*(e) = \hat w(e) + \Delta$. Clearly, $G^*$ is a graph that has {\em non-negative} edge weights so $G^*$ is a valid instance to $\compproblem{mwpm}$. Moreover, $G^*$ can be constructed in polynomial-time.

Your task is to prove the correctness of the reduction by proving each of the following claims.

\begin{enumerate}[label = (\alph*)]
    \item Firstly, argue that $G$ has a perfect matching if and only if $G^*$ has a perfect matching.

    \item Suppose that $G^*$ has a perfect matching. Prove that a maximum weighted matching in $G^*$ is also a maximum weighted {\em perfect} matching.

    \item Let $M$ be a matching. Prove that $M$ is a minimum-cost perfect matching in $G$ {\em if and only if} $M$ is a maximum-weighted perfect matching in $G^*$.

    \item Hence, conclude that the reduction is correct.
\end{enumerate}
\end{question}

\begin{solution}
\begin{enumerate}[label = (\alph*)]
    \item A perfect matching does not depend on $w$. $G$ by definition contains the exact same vertices and edges as $G^*$, so if there exists some set $U \subseteq E'=^*$ with $U \subseteq E$ that satisfies the conditions of being a perfect matching. The converse is also true for the exact same reason.
    
    \item For the general case, the maximum weighted matching of some graph does not necessarily have to be a perfect matching. In this case, however, we can use the construction of $G^*$ to see why this is the case under the proposed reduction method. We know that $\Delta > n > 0$ since each $\hat{w}(e) > \geq 1$ from its definition. Our reduction to $w^*(e)$ is bounded on the bottom by $1 + \Delta$ when $w(e) = w_\text{max}$, and can be no larger than $w_\text{max} - w_\text{min} + 1 + \Delta$. It's trivial to see that $w_\text{max} - w_\text{min} \leq \Delta$ by the definition of $\Delta$.\\

Now, let's assume that we have a matching $M$ that is not a perfect matching. This would mean that, since $n$ is even, there are at least two vertices that are not covered. According to our result, the size of each edge is bounded by $w_\text{max} - w_\text{min} + 1 + \Delta$. If we were to use the perfect matching we know $G^*$ has, we would be able increase the total weight by $\Delta + 1$ in the worst case. In other words, it would be better to have more edges in $M$ due to the bounds on $w^*$.
    
    \item Consider rewriting out $w^*(M)$ in terms of $w(M)$.
\begin{align*}
	w^*(M) &= \sum_{e \in M} w^*(e)\\
	&= \sum_{e \in M} \left[ w_\text{max} - w(e) + 1 + \Delta \right]\\
	&= |M|\left( \cdot w_\text{max} + \Delta + 1\right) - \sum_{e \in M} w(e)\\
	&= |M|\left( \cdot w_\text{max} + \Delta + 1\right) - w(M).
\end{align*}

In order to maximise $w^*(M)$, we need to minimise $w(M)$. $|M|$ will need to be the maximum and a fixed size from the result in part (b). The converse is obviously true.

    \item From part (c), we can see that $M$ is a minimum-cost perfect matching in $G$ if and only if $M$ is a maximum-weighted perfect matching in $G^*$, tThus, solving the $\compproblem{MaxWeightedPerfectMatching}$ in $G^*$ is equivalent to solving the $\compproblem{MinCostPerfectMatching}$ in $G$.
\end{enumerate}
\end{solution}
\end{document}